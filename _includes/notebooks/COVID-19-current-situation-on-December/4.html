<div class="container cell border-box-sizing code_cell rendered" id="notebook-container"><div class="input"><div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell"><div class="input_area"><div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Filter out problematic data points (The West Bank and Gaza had a negative value, cruise ships were associated with Canada, etc.)</span>
<span class="n">removed_states</span> <span class="o">=</span> <span class="s2">&quot;Recovered|Grand Princess|Diamond Princess&quot;</span>
<span class="n">removed_countries</span> <span class="o">=</span> <span class="s2">&quot;US|The West Bank and Gaza&quot;</span>

<span class="n">confirmed_global_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Province/State&quot;</span><span class="p">:</span> <span class="s2">&quot;Province_State&quot;</span><span class="p">,</span> <span class="s2">&quot;Country/Region&quot;</span><span class="p">:</span> <span class="s2">&quot;Country_Region&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">deaths_global_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Province/State&quot;</span><span class="p">:</span> <span class="s2">&quot;Province_State&quot;</span><span class="p">,</span> <span class="s2">&quot;Country/Region&quot;</span><span class="p">:</span> <span class="s2">&quot;Country_Region&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">recovered_global_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Province/State&quot;</span><span class="p">:</span> <span class="s2">&quot;Province_State&quot;</span><span class="p">,</span> <span class="s2">&quot;Country/Region&quot;</span><span class="p">:</span> <span class="s2">&quot;Country_Region&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">confirmed_global_df</span> <span class="o">=</span> <span class="n">confirmed_global_df</span><span class="p">[</span><span class="o">~</span><span class="n">confirmed_global_df</span><span class="p">[</span><span class="s2">&quot;Province_State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">removed_states</span><span class="p">)]</span>
<span class="n">deaths_global_df</span>    <span class="o">=</span> <span class="n">deaths_global_df</span><span class="p">[</span><span class="o">~</span><span class="n">deaths_global_df</span><span class="p">[</span><span class="s2">&quot;Province_State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">removed_states</span><span class="p">)]</span>
<span class="n">recovered_global_df</span> <span class="o">=</span> <span class="n">recovered_global_df</span><span class="p">[</span><span class="o">~</span><span class="n">recovered_global_df</span><span class="p">[</span><span class="s2">&quot;Province_State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">removed_states</span><span class="p">)]</span>

<span class="n">confirmed_global_df</span> <span class="o">=</span> <span class="n">confirmed_global_df</span><span class="p">[</span><span class="o">~</span><span class="n">confirmed_global_df</span><span class="p">[</span><span class="s2">&quot;Country_Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">removed_countries</span><span class="p">)]</span>
<span class="n">deaths_global_df</span>    <span class="o">=</span> <span class="n">deaths_global_df</span><span class="p">[</span><span class="o">~</span><span class="n">deaths_global_df</span><span class="p">[</span><span class="s2">&quot;Country_Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">removed_countries</span><span class="p">)]</span>
<span class="n">recovered_global_df</span> <span class="o">=</span> <span class="n">recovered_global_df</span><span class="p">[</span><span class="o">~</span><span class="n">recovered_global_df</span><span class="p">[</span><span class="s2">&quot;Country_Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;nan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">removed_countries</span><span class="p">)]</span>
</pre></div></div></div></div></div>